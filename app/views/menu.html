<!DOCTYPE html>
<html lang="en" class="yui3-loading">
    <head>
        <title>#{get 'title' /}</title>
        <link rel="stylesheet" media="screen" href="@{'/public/stylesheets/main.css'}">
        <link id="colorCss" rel="stylesheet" href="@{'/public/stylesheets/white.css'}">
        <link rel="stylesheet" href="@{'/public/stylesheets/reset-min.css'}">
        <link rel="stylesheet" href="@{'/public/stylesheets/grids-min.css'}">
        <link rel="stylesheet" href="@{'/public/stylesheets/fonts-min.css'}">
        <link rel="stylesheet" href="@{'/public/stylesheets/base-min.css'}">
        <link rel="stylesheet" href="@{'/public/stylesheets/node-menunav.css'}">
        <link rel="stylesheet" href="@{'/public/stylesheets/jquery-ui-1.8.16.custom.css'}">
       #{get 'moreStyles' /}
       	<script>
		   function changeScreenSize(w,h)
		     {
		       window.resizeTo( w,h )
		     }
		</script>
        <link rel="shortcut icon" type="image/png" href="@{'/public/images/favicon.png'}">
        <script src="@{'/public/javascripts/jquery-1.6.2.min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/jquery-ui-1.8.16.custom.min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/jquery.maskedinput-1.3.min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/application.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/shortcut.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/oop-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/event-custom-base-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/dom-core-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/dom-base-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/selector-native-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/selector-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/node-core-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/node-base-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/event-base-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/event-delegate-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/node-event-delegate-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/pluginhost-base-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/pluginhost-config-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/node-pluginhost-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/dom-style-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/dom-screen-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/node-screen-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/node-style-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/classnamemanager-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/event-custom-complex-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/attribute-base-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/attribute-complex-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/base-base-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/plugin-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/event-simulate-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/node-event-simulate-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/event-synthetic-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/event-key-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/event-focus-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/node-focusmanager-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/node-menunav-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        <script src="@{'/public/javascripts/yui/intl-min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
        #{get 'moreScripts' /}        
    </head>
    <body class="yui3-skin-sam" onload="changeScreenSize(1024,800);">
    <div class="yui3-g" id="hd">
    <div class="yui3-u-1-5"></div>
    <div class="yui3-u-3-5">
    <img alt="Apotech" src="@{'/public/images/apotech.jpg'}"/>
    </div>
    <div class="yui3-u-1-5"></div>
    </div>
    <div class="yui3-g" id="bd">
    <div class="yui3-u-1-12" id="left">&nbsp;</div>
    <div class="yui3-u-5-6" id="main">
    	#{include 'menulist.html'/}
        #{doLayout /}
    </div>
    <div class="yui3-u-1-12" id="right">&nbsp;</div>
    </div>
    <script>
	
	    //  Call the "use" method, passing in "node-menunav".  This will load the
	    //  script and CSS for the MenuNav Node Plugin and all of the required
	    //  dependencies.
	
	    YUI().use('node-menunav', function(Y) {
	
	        //  Retrieve the Node instance representing the root menu
	        //  (<div id="productsandservices">) and call the "plug" method
	        //  passing in a reference to the MenuNav Node Plugin.
	
	        var menu = Y.one("#productsandservices");
	
	        menu.plug(Y.Plugin.NodeMenuNav);
	
	        //  Show the menu now that it is ready
	
	        menu.get("ownerDocument").get("documentElement").removeClass("yui3-loading");
	
	    });
	    $('a').each(function() {
	    	var link=$(this).attr('href');
	    	if($(this).attr('key'))
	    	shortcut.add($(this).attr('key'),function() {
	    		window.location=link;
	    	});
	    });
	</script>
<script>
$(function() {
$('#bd').equalHeights();
var listNotaAction = #{jsAction @Application.generateDirectNota(':resepId') /}
var listAction = #{jsAction @Application.saveConfigColor(':colorId') /}
$('a.colorLink').click(function() {
	var teks = $(this).text();
	var hrefCss = $('#colorCss').attr('href');
	hrefCss=hrefCss.substring(0,hrefCss.lastIndexOf('/'))+'/'+teks+'.css';
	$('#colorCss').attr('href',hrefCss);
	$.getJSON(listAction({colorId:teks}));
});
$('input.autocomplete-relation').each(function() {
	   var $input = $(this);
	   
	   // Create a hidden input with the same form control name to submit the value.
	   var controlId = $input.attr('id');
	   var controlName = $input.attr('name');
	   var real_value = $input.attr('real_value');
	   $(':input[name="key_'+controlName+'"]').remove();
	   var $hidden = $('<input type="hidden"/>').attr('name', "key_"+controlName).attr('id', "key_"+controlId);
	   if(real_value.length>0) {
		   $hidden.val(real_value);
	   }
	   $input.after($hidden);//.attr('name', controlName + '_label');
	   // Set-up the autocomplete widget.
	   var serverUrl = $input.data('url');
	   $(this).autocomplete({
	      source: serverUrl,
	      focus: function(event, ui) {
	         // Set the text input value to the focused item's label, instead of the value.
	         $input.val(ui.item.label);
	         return false;
	      },
	      select: function(event, ui) {
	         // Save the selection item and value in the two inputs.
	         $input.val(ui.item.label);
	         $hidden.val(ui.item.value);
	         $input.trigger('ubah');
	         return false;
	      }
	   });
	});
var tabindex = 1;
$(':input').each(function() {
	if (this.type != "hidden") {
    	var $input = $(this);
    	if(!$input.attr("readonly")) {
        $input.attr("tabIndex", tabindex);
        tabindex++;
		} else {
			$input.attr("tabIndex", "-1");
		}
	}
});
$(':input[tabIndex="1"]').focus();
$('form').submit(function() {
   $(this).find('input.autocomplete-relation').attr('disabled', 'disabled');
});
var listActionGetColor = #{jsAction @Application.getConfigColor(':userId') /}
var userid='${session.get("username")}';
$.getJSON(listActionGetColor({userId:userid}), function(data) {
	var hrefCss = $('#colorCss').attr('href');
	hrefCss=hrefCss.substring(0,hrefCss.lastIndexOf('/'))+'/'+data+'.css';
	$('#colorCss').attr('href',hrefCss);
});
$('#printer').click(function() {
            var applet = document.jZebra;
            if (applet != null) {
               // Searches for locally installed printer with "zebra" in the name
               applet.findPrinter('EPSON LX-300+II ESC/P');
			   var resepId = "${resep?.idResep}";
			   var hasil = "";
			   $.getJSON(listNotaAction({resepId:resepId}),function(data) {
					applet.clear();
		            applet.append(data);
					applet.print();
					while (!applet.isDonePrinting()) {
				            	// Wait
				    }
					var e = applet.getException();
					if(e != null){
						//alert("Exception occured: " + e.getLocalizedMessage());
						alert("Printer tidak ditemukan atau belum terhubung\n"+
					    	"atau nama printer tidak sesuai dengan settingan properties di aplikasi");
					}
					if(e == null) {
				     	_sendValueCetak();
				    }
				});
            }
         });
});</script>
<applet name="jZebra" code="jzebra.RawPrintApplet.class" alt="jZebra did not load properly" archive="@{'/public/applets/jzebra.jar'}" width="0" height="0">
         <param name="printer" value="zebra">
      </applet>
    </body>
</html>
